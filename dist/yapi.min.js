!function(){function a(a){return"function"==typeof a}function b(a){setTimeout(a)}function c(b,e){var g=!1,h=function(a){g||(g=!0,c(b,a))},i=function(a){g||(g=!0,b.reject(a))};if(e===b.promise)b.reject(new TypeError);else if(e instanceof f)e.then(function(a){b.resolve(a)},function(a){b.reject(a)});else if("object"==typeof e&&null!==e||a(e)){try{then=e.then}catch(j){b.reject(j)}if("pending"!==b.promise.status)return;if(a(then))try{then.call(e,h,i)}catch(j){g||b.reject(j)}else d(b.promise,e)}else d(b.promise,e)}function d(d,e){for(d.value=e,d.status="fulfilled",i=0,length=d.pendings.length;i<length;i++)pending=d.pendings[i],function(d){a(d.onFulfilled)?b(function(){var a;try{a=d.onFulfilled.call(void 0,e),c(d.deferred,a)}catch(b){d.deferred.reject(b)}}):d.deferred.resolve(e)}(pending)}function e(){this.promise=new f}function f(){this.pendings=[],this.status="pending"}var g=this;e.prototype.resolve=function(a){"pending"===this.promise.status&&c(this,a)},e.prototype.reject=function(d){var e,f,g;if("pending"===this.promise.status)for(this.promise.value=d,this.promise.status="rejected",e=0,f=this.promise.pendings.length;f>e;e++)g=this.promise.pendings[e],function(e){a(e.onRejected)?b(function(){var a;try{a=e.onRejected.call(void 0,d),c(e.deferred,a)}catch(b){e.deferred.reject(b)}}):e.deferred.reject(d)}(g)},f.prototype.then=function(d,f){var g,h=new e,i=this;return"pending"===this.status?this.pendings.push({deferred:h,onFulfilled:d,onRejected:f}):"fulfilled"===this.status?a(d)?b(function(){try{g=d(i.value),c(h,g)}catch(a){h.reject(a)}}):h.resolve(this.value):"rejected"===this.status&&(a(f)?b(function(){try{g=f(i.value),c(h,g)}catch(a){h.reject(a)}}):h.reject(this.value)),h.promise};var h={};h.defer=function(){return new e},h.createPromise=function(a){var b=new e,c=function(a){b.resolve(a)},d=function(a){b.reject(a)};return a.call(null,c,d),b.promise},"undefined"!=typeof module?module.exports=h:g.YAPI=h}();