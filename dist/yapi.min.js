!function(){function a(a){return"function"==typeof a}function b(a){setTimeout(a)}function c(c,e,f){a(c[e])?b(function(){var a;try{a=c[e].call(void 0,f),d(c.deferred,a)}catch(b){c.deferred.reject(b)}}):"onFulfilled"===e?c.deferred.resolve(f):c.deferred.reject(f)}function d(b,c){var f=!1,h=function(a){f||(f=!0,d(b,a))},i=function(a){f||(f=!0,b.reject(a))};if(c===b.promise)b.reject(new TypeError);else if(c instanceof g)c.then(function(a){b.resolve(a)},function(a){b.reject(a)});else if("object"==typeof c&&null!==c||a(c)){try{then=c.then}catch(j){b.reject(j)}if("pending"!==b.promise.status)return;if(a(then))try{then.call(c,h,i)}catch(j){f||b.reject(j)}else e(b.promise,c)}else e(b.promise,c)}function e(a,b){for(a.value=b,a.status="fulfilled",i=0,length=a.pendings.length;i<length;i++)pending=a.pendings[i],c(pending,"onFulfilled",b)}function f(){this.promise=new g}function g(){this.pendings=[],this.status="pending"}var h=this;f.prototype.resolve=function(a){"pending"===this.promise.status&&d(this,a)},f.prototype.reject=function(a){var b,d,e;if("pending"===this.promise.status)for(this.promise.value=a,this.promise.status="rejected",b=0,d=this.promise.pendings.length;d>b;b++)e=this.promise.pendings[b],c(e,"onRejected",a)},g.prototype.then=function(c,e){var g,h=new f,i=this;return"pending"===this.status?this.pendings.push({deferred:h,onFulfilled:c,onRejected:e}):"fulfilled"===this.status?a(c)?b(function(){try{g=c(i.value),d(h,g)}catch(a){h.reject(a)}}):h.resolve(this.value):"rejected"===this.status&&(a(e)?b(function(){try{g=e(i.value),d(h,g)}catch(a){h.reject(a)}}):h.reject(this.value)),h.promise};var j={};j.defer=function(){return new f},j.createPromise=function(a){var b=new f,c=function(a){b.resolve(a)},d=function(a){b.reject(a)};return a.call(null,c,d),b.promise},"undefined"!=typeof module?module.exports=j:h.YAPI=j}();