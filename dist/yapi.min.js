!function(){function a(a){return"function"==typeof a}function b(a){setTimeout(a)}function c(c,e,f){a(c[e])?b(function(){var a;try{a=c[e].call(void 0,f),d(c.deferred,a)}catch(b){c.deferred.reject(b)}}):"onFulfilled"===e?c.deferred.resolve(f):c.deferred.reject(f)}function d(b,c){var f,h=!1,i=function(a){h||(h=!0,d(b,a))},j=function(a){h||(h=!0,b.reject(a))};if(c===b.promise)b.reject(new TypeError);else if(c instanceof g)c.then(function(a){b.resolve(a)},function(a){b.reject(a)});else if("object"==typeof c&&null!==c||a(c)){try{f=c.then}catch(k){b.reject(k)}if("pending"!==b.promise.status)return;if(a(f))try{f.call(c,i,j)}catch(k){h||b.reject(k)}else e(b.promise,c)}else e(b.promise,c)}function e(a,b){var d,e;for(a.value=b,a.status="fulfilled",d=0,e=a.pendings.length;e>d;d++)c(a.pendings[d],"onFulfilled",b)}function f(){this.promise=new g}function g(){this.pendings=[],this.status="pending"}var h=this;f.prototype.resolve=function(a){"pending"===this.promise.status&&d(this,a)},f.prototype.reject=function(a){var b,d;if("pending"===this.promise.status)for(this.promise.value=a,this.promise.status="rejected",b=0,d=this.promise.pendings.length;d>b;b++)c(this.promise.pendings[b],"onRejected",a)},g.prototype.then=function(c,e){var g=new f,h=this;return"pending"===this.status?this.pendings.push({deferred:g,onFulfilled:c,onRejected:e}):"fulfilled"===this.status?a(c)?b(function(){try{d(g,c(h.value))}catch(a){g.reject(a)}}):g.resolve(this.value):"rejected"===this.status&&(a(e)?b(function(){try{d(g,e(h.value))}catch(a){g.reject(a)}}):g.reject(this.value)),g.promise};var i={};i.defer=function(){return new f},i.createPromise=function(a){var b=new f,c=function(a){b.resolve(a)},d=function(a){b.reject(a)};return a.call(null,c,d),b.promise},"undefined"!=typeof module?module.exports=i:h.YAPI=i}();